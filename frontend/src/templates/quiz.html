{% extends 'base.html' %}
{% block title %}Civics Quiz ‚Äî Political App{% endblock %}
{% block content %}
<style>
  .quiz-container {
    max-width: 900px;
    margin: 0 auto;
  }

  .quiz-header {
    text-align: center;
    margin-bottom: 2rem;
  }

  .quiz-header h1 {
    color: #333;
    margin-bottom: 0.5rem;
  }

  .quiz-description {
    color: #666;
    font-size: 1.1rem;
    max-width: 600px;
    margin: 0 auto 2rem;
    line-height: 1.6;
  }

  .progress-bar-container {
    background: #e0e0e0;
    border-radius: 20px;
    height: 12px;
    margin-bottom: 2rem;
    overflow: hidden;
  }

  .progress-bar {
    background: linear-gradient(90deg, #667eea, #764ba2);
    height: 100%;
    width: 0%;
    transition: width 0.4s ease;
    border-radius: 20px;
  }

  .progress-text {
    text-align: center;
    color: #666;
    font-size: 0.9rem;
    margin-top: 0.5rem;
  }

  .question-card {
    background: white;
    padding: 2rem;
    border-radius: 15px;
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
    margin-bottom: 1.5rem;
    transition: all 0.3s ease;
  }

  .question-card.answered-correct {
    border: 3px solid #28a745;
  }

  .question-card.answered-wrong {
    border: 3px solid #dc3545;
  }

  .question-number {
    color: #667eea;
    font-weight: 700;
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
  }

  .question-text {
    color: #333;
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 1.5rem;
    line-height: 1.5;
  }

  .answer-option {
    background: #f8f9fa;
    border: 2px solid #e0e0e0;
    border-radius: 10px;
    padding: 1rem 1.5rem;
    margin-bottom: 0.75rem;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
  }

  .answer-option:hover {
    background: #e9ecef;
    transform: translateX(5px);
  }

  .answer-option input[type="radio"] {
    margin-right: 1rem;
    width: 20px;
    height: 20px;
    cursor: pointer;
    accent-color: #667eea;
  }

  .answer-option label {
    cursor: pointer;
    margin: 0;
    flex: 1;
    font-size: 1rem;
    color: #333;
  }

  .answer-option.selected {
    background: #e7ecff;
    border-color: #667eea;
  }

  .answer-option.correct {
    background: #d4edda;
    border-color: #28a745;
  }

  .answer-option.wrong {
    background: #f8d7da;
    border-color: #dc3545;
  }

  .explanation {
    background: #fff3cd;
    border-left: 4px solid #ffc107;
    padding: 1rem;
    margin-top: 1rem;
    border-radius: 5px;
    display: none;
  }

  .explanation.show {
    display: block;
    animation: slideDown 0.3s ease;
  }

  .explanation-title {
    font-weight: 700;
    color: #856404;
    margin-bottom: 0.5rem;
  }

  .explanation-text {
    color: #856404;
    line-height: 1.6;
  }

  .quiz-actions {
    display: flex;
    gap: 1rem;
    justify-content: center;
    margin-top: 2rem;
  }

  .results-card {
    background: white;
    padding: 3rem;
    border-radius: 20px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
    text-align: center;
    display: none;
  }

  .results-card.show {
    display: block;
    animation: fadeIn 0.5s ease;
  }

  .score-display {
    font-size: 4rem;
    font-weight: 700;
    color: #667eea;
    margin: 1rem 0;
  }

  .score-message {
    font-size: 1.5rem;
    color: #333;
    margin-bottom: 1rem;
  }

  .score-details {
    color: #666;
    font-size: 1.1rem;
    margin-bottom: 2rem;
  }

  .badge {
    display: inline-block;
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-weight: 600;
    margin: 0.5rem;
  }

  .badge-excellent {
    background: #d4edda;
    color: #155724;
  }

  .badge-good {
    background: #d1ecf1;
    color: #0c5460;
  }

  .badge-needs-work {
    background: #fff3cd;
    color: #856404;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: scale(0.9);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes slideDown {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>

<div class="quiz-container">
  <div class="quiz-header">
    <h1>üèõÔ∏è U.S. Civics & Government Quiz</h1>
    <p class="quiz-description">
      Test your knowledge of U.S. government, history, and civic principles. 
      Select your answers and get instant feedback with detailed explanations!
    </p>
  </div>

  <div class="progress-bar-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>
  <div class="progress-text" id="progressText">0 of 10 questions answered</div>

  <form id="quizForm">
    <!-- Question 1 -->
    <div class="question-card" data-question="1">
      <div class="question-number">Question 1 of 10</div>
      <div class="question-text">What is the supreme law of the land?</div>
      <div class="answer-option">
        <input type="radio" name="q1" value="a" id="q1a">
        <label for="q1a">The Declaration of Independence</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q1" value="b" id="q1b">
        <label for="q1b">The Constitution</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q1" value="c" id="q1c">
        <label for="q1c">Federal Statutes</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q1" value="d" id="q1d">
        <label for="q1d">The Bill of Rights</label>
      </div>
      <div class="explanation">
        <div class="explanation-title">‚úì Correct Answer: The Constitution</div>
        <div class="explanation-text">The U.S. Constitution is the supreme law of the land. It establishes the framework of the federal government and is the highest form of law in the United States.</div>
      </div>
    </div>

    <!-- Question 2 -->
    <div class="question-card" data-question="2">
      <div class="question-number">Question 2 of 10</div>
      <div class="question-text">Who makes federal laws?</div>
      <div class="answer-option">
        <input type="radio" name="q2" value="a" id="q2a">
        <label for="q2a">The President</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q2" value="b" id="q2b">
        <label for="q2b">The Supreme Court</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q2" value="c" id="q2c">
        <label for="q2c">Congress</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q2" value="d" id="q2d">
        <label for="q2d">State Legislatures</label>
      </div>
      <div class="explanation">
        <div class="explanation-title">‚úì Correct Answer: Congress</div>
        <div class="explanation-text">Congress, which consists of the Senate and the House of Representatives, is the legislative branch responsible for making federal laws.</div>
      </div>
    </div>

    <!-- Question 3 -->
    <div class="question-card" data-question="3">
      <div class="question-number">Question 3 of 10</div>
      <div class="question-text">What are the three branches of government?</div>
      <div class="answer-option">
        <input type="radio" name="q3" value="a" id="q3a">
        <label for="q3a">Executive, Legislative, Judicial</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q3" value="b" id="q3b">
        <label for="q3b">Federal, State, Local</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q3" value="c" id="q3c">
        <label for="q3c">President, Congress, Senate</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q3" value="d" id="q3d">
        <label for="q3d">Law, Order, Finance</label>
      </div>
      <div class="explanation">
        <div class="explanation-title">‚úì Correct Answer: Executive, Legislative, Judicial</div>
        <div class="explanation-text">The three branches of government are: Executive (President), Legislative (Congress), and Judicial (Courts). This separation of powers ensures checks and balances.</div>
      </div>
    </div>

    <!-- Question 4 -->
    <div class="question-card" data-question="4">
      <div class="question-number">Question 4 of 10</div>
      <div class="question-text">How many U.S. senators are there?</div>
      <div class="answer-option">
        <input type="radio" name="q4" value="a" id="q4a">
        <label for="q4a">50</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q4" value="b" id="q4b">
        <label for="q4b">100</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q4" value="c" id="q4c">
        <label for="q4c">435</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q4" value="d" id="q4d">
        <label for="q4d">535</label>
      </div>
      <div class="explanation">
        <div class="explanation-title">‚úì Correct Answer: 100</div>
        <div class="explanation-text">There are 100 U.S. senators, with 2 senators representing each of the 50 states, regardless of population size.</div>
      </div>
    </div>

    <!-- Question 5 -->
    <div class="question-card" data-question="5">
      <div class="question-number">Question 5 of 10</div>
      <div class="question-text">What are the first ten amendments to the Constitution called?</div>
      <div class="answer-option">
        <input type="radio" name="q5" value="a" id="q5a">
        <label for="q5a">The Articles</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q5" value="b" id="q5b">
        <label for="q5b">The Bill of Rights</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q5" value="c" id="q5c">
        <label for="q5c">The Preamble</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q5" value="d" id="q5d">
        <label for="q5d">The Federalist Papers</label>
      </div>
      <div class="explanation">
        <div class="explanation-title">‚úì Correct Answer: The Bill of Rights</div>
        <div class="explanation-text">The Bill of Rights consists of the first ten amendments to the Constitution, guaranteeing fundamental rights and freedoms to American citizens.</div>
      </div>
    </div>

    <!-- Question 6 -->
    <div class="question-card" data-question="6">
      <div class="question-number">Question 6 of 10</div>
      <div class="question-text">Who was the principal author of the Declaration of Independence?</div>
      <div class="answer-option">
        <input type="radio" name="q6" value="a" id="q6a">
        <label for="q6a">George Washington</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q6" value="b" id="q6b">
        <label for="q6b">Benjamin Franklin</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q6" value="c" id="q6c">
        <label for="q6c">Thomas Jefferson</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q6" value="d" id="q6d">
        <label for="q6d">John Adams</label>
      </div>
      <div class="explanation">
        <div class="explanation-title">‚úì Correct Answer: Thomas Jefferson</div>
        <div class="explanation-text">Thomas Jefferson was the principal author of the Declaration of Independence, drafted in 1776. While others contributed, Jefferson wrote the initial draft.</div>
      </div>
    </div>

    <!-- Question 7 -->
    <div class="question-card" data-question="7">
      <div class="question-number">Question 7 of 10</div>
      <div class="question-text">How long is a U.S. presidential term?</div>
      <div class="answer-option">
        <input type="radio" name="q7" value="a" id="q7a">
        <label for="q7a">2 years</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q7" value="b" id="q7b">
        <label for="q7b">4 years</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q7" value="c" id="q7c">
        <label for="q7c">6 years</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q7" value="d" id="q7d">
        <label for="q7d">8 years</label>
      </div>
      <div class="explanation">
        <div class="explanation-title">‚úì Correct Answer: 4 years</div>
        <div class="explanation-text">A U.S. presidential term is 4 years. A president can serve a maximum of two terms (8 years total) as established by the 22nd Amendment.</div>
      </div>
    </div>

    <!-- Question 8 -->
    <div class="question-card" data-question="8">
      <div class="question-number">Question 8 of 10</div>
      <div class="question-text">Which amendment guarantees freedom of speech, religion, and the press?</div>
      <div class="answer-option">
        <input type="radio" name="q8" value="a" id="q8a">
        <label for="q8a">First Amendment</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q8" value="b" id="q8b">
        <label for="q8b">Second Amendment</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q8" value="c" id="q8c">
        <label for="q8c">Fifth Amendment</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q8" value="d" id="q8d">
        <label for="q8d">Tenth Amendment</label>
      </div>
      <div class="explanation">
        <div class="explanation-title">‚úì Correct Answer: First Amendment</div>
        <div class="explanation-text">The First Amendment protects freedom of speech, religion, press, assembly, and petition. It's one of the most important protections in the Bill of Rights.</div>
      </div>
    </div>

    <!-- Question 9 -->
    <div class="question-card" data-question="9">
      <div class="question-number">Question 9 of 10</div>
      <div class="question-text">How many justices serve on the U.S. Supreme Court?</div>
      <div class="answer-option">
        <input type="radio" name="q9" value="a" id="q9a">
        <label for="q9a">7</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q9" value="b" id="q9b">
        <label for="q9b">9</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q9" value="c" id="q9c">
        <label for="q9c">11</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q9" value="d" id="q9d">
        <label for="q9d">13</label>
      </div>
      <div class="explanation">
        <div class="explanation-title">‚úì Correct Answer: 9</div>
        <div class="explanation-text">There are 9 justices on the U.S. Supreme Court: 1 Chief Justice and 8 Associate Justices. They serve lifetime appointments.</div>
      </div>
    </div>

    <!-- Question 10 -->
    <div class="question-card" data-question="10">
      <div class="question-number">Question 10 of 10</div>
      <div class="question-text">What is the minimum voting age in the United States?</div>
      <div class="answer-option">
        <input type="radio" name="q10" value="a" id="q10a">
        <label for="q10a">16</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q10" value="b" id="q10b">
        <label for="q10b">18</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q10" value="c" id="q10c">
        <label for="q10c">21</label>
      </div>
      <div class="answer-option">
        <input type="radio" name="q10" value="d" id="q10d">
        <label for="q10d">25</label>
      </div>
      <div class="explanation">
        <div class="explanation-title">‚úì Correct Answer: 18</div>
        <div class="explanation-text">The 26th Amendment, ratified in 1971, lowered the voting age from 21 to 18 years old nationwide.</div>
      </div>
    </div>

    <div class="quiz-actions">
      <button type="button" class="btn btn-secondary" id="resetBtn">Reset Quiz</button>
      <button type="submit" class="btn btn-primary" id="submitBtn">Submit Quiz</button>
    </div>
  </form>

  <div class="results-card" id="resultsCard">
    <h2>üéâ Quiz Complete!</h2>
    <div class="score-display" id="scoreDisplay">0/10</div>
    <div class="score-message" id="scoreMessage"></div>
    <div class="score-details" id="scoreDetails"></div>
    <div id="badgeContainer"></div>
    <div class="quiz-actions">
      <button type="button" class="btn btn-primary" id="retakeBtn">Retake Quiz</button>
      <a href="/" class="btn btn-secondary">Back to Home</a>
    </div>
  </div>
</div>

<script>
  const correctAnswers = {
    q1: 'b', q2: 'c', q3: 'a', q4: 'b', q5: 'b',
    q6: 'c', q7: 'b', q8: 'a', q9: 'b', q10: 'b'
  };

  let answeredCount = 0;
  const totalQuestions = 10;

  // Track selected answers and update UI
  document.querySelectorAll('input[type="radio"]').forEach(radio => {
    radio.addEventListener('change', function() {
      const questionName = this.name;
      const card = this.closest('.question-card');
      
      // Remove selected class from all options in this question
      card.querySelectorAll('.answer-option').forEach(opt => opt.classList.remove('selected'));
      
      // Add selected class to chosen option
      this.closest('.answer-option').classList.add('selected');
      
      // Update progress
      updateProgress();
    });
  });

  function updateProgress() {
    answeredCount = 0;
    for (let i = 1; i <= totalQuestions; i++) {
      if (document.querySelector(`input[name="q${i}"]:checked`)) {
        answeredCount++;
      }
    }
    
    const percentage = (answeredCount / totalQuestions) * 100;
    document.getElementById('progressBar').style.width = percentage + '%';
    document.getElementById('progressText').textContent = `${answeredCount} of ${totalQuestions} questions answered`;
  }

  // Submit quiz
  document.getElementById('quizForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    // Check if all questions answered
    if (answeredCount < totalQuestions) {
      alert(`Please answer all questions. You have ${totalQuestions - answeredCount} questions remaining.`);
      return;
    }
    
    let score = 0;
    
    // Grade each question
    for (let i = 1; i <= totalQuestions; i++) {
      const selected = document.querySelector(`input[name="q${i}"]:checked`);
      const card = document.querySelector(`.question-card[data-question="${i}"]`);
      const explanation = card.querySelector('.explanation');
      
      if (selected) {
        const userAnswer = selected.value;
        const correctAnswer = correctAnswers[`q${i}`];
        
        if (userAnswer === correctAnswer) {
          score++;
          card.classList.add('answered-correct');
          selected.closest('.answer-option').classList.add('correct');
        } else {
          card.classList.add('answered-wrong');
          selected.closest('.answer-option').classList.add('wrong');
          // Highlight correct answer
          const correctOption = card.querySelector(`input[value="${correctAnswer}"]`);
          correctOption.closest('.answer-option').classList.add('correct');
        }
        
        explanation.classList.add('show');
      }
    }
    
    // Disable all inputs
    document.querySelectorAll('input[type="radio"]').forEach(r => r.disabled = true);
    
    // Show results
    showResults(score);
    
    // Scroll to top
    window.scrollTo({ top: 0, behavior: 'smooth' });
  });

  function showResults(score) {
    const percentage = (score / totalQuestions) * 100;
    
    document.getElementById('scoreDisplay').textContent = `${score}/${totalQuestions}`;
    
    let message, badge;
    if (percentage >= 90) {
      message = 'Outstanding! You have excellent knowledge of U.S. civics!';
      badge = '<span class="badge badge-excellent">üèÜ Civics Expert</span>';
    } else if (percentage >= 70) {
      message = 'Great job! You have a solid understanding of U.S. government!';
      badge = '<span class="badge badge-good">‚≠ê Well Informed</span>';
    } else if (percentage >= 50) {
      message = 'Not bad! Keep learning to improve your civics knowledge!';
      badge = '<span class="badge badge-needs-work">üìö Learning</span>';
    } else {
      message = 'Keep studying! Review the explanations below to learn more.';
      badge = '<span class="badge badge-needs-work">üìñ Beginner</span>';
    }
    
    document.getElementById('scoreMessage').textContent = message;
    document.getElementById('scoreDetails').textContent = `You answered ${score} out of ${totalQuestions} questions correctly (${percentage.toFixed(0)}%)`;
    document.getElementById('badgeContainer').innerHTML = badge;
    
    document.getElementById('resultsCard').classList.add('show');
    document.getElementById('submitBtn').style.display = 'none';
  }

  // Reset quiz
  function resetQuiz() {
    // Reset all selections
    document.querySelectorAll('input[type="radio"]').forEach(r => {
      r.checked = false;
      r.disabled = false;
    });
    
    // Reset styling
    document.querySelectorAll('.question-card').forEach(card => {
      card.classList.remove('answered-correct', 'answered-wrong');
    });
    
    document.querySelectorAll('.answer-option').forEach(opt => {
      opt.classList.remove('selected', 'correct', 'wrong');
    });
    
    document.querySelectorAll('.explanation').forEach(exp => {
      exp.classList.remove('show');
    });
    
    // Reset progress
    answeredCount = 0;
    updateProgress();
    
    // Hide results
    document.getElementById('resultsCard').classList.remove('show');
    document.getElementById('submitBtn').style.display = 'inline-block';
    
    // Scroll to top
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }

  document.getElementById('resetBtn').addEventListener('click', resetQuiz);
  document.getElementById('retakeBtn').addEventListener('click', resetQuiz);
</script>
{% endblock %}
